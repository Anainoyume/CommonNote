目前做了两种判定方法：一种追求精确，在武器上放置 `AttackPoint`，设计一个组件。该组件按顺序记录所有的 `AttackPoint`。每一帧将其用 `Physics.Raycast` 两两相连，相当于对刀刃描一个边，然后看看刀刃打到人没有，这种方法挺不错的。

但是我做的时候遇到了一个问题，我的 BOSS 模型一来比较大，二来攻击动作三下分别为：左上劈，右上劈，回旋下劈。这样会有一个问题，当比较小的 Player 贴着 BOSS 的正前方时。由于手臂没有做对应的处理，按照 ”刀锋有没有劈到角色“ 这个判定条件，刀确实没有劈到。但我意识到从视觉效果上，会有一种BOSS劈到玩家的错觉。而事实上大部分时候玩家靠近BOSS非常近的时候也是一定会被打到的。我意识到也许不需要做的过于精确。

现在我就多了 2 个新的方案：

1. 做扇形攻击区域

   这个方法比较好做，但是有一个缺点，那就是无法得到 刀 大致劈在了 角色 的那个位置。考虑到我之后也许想做哪里被打到就朝哪里受击，以及在那个位置做一点飙血的特效。我就没有采取这个方案。

2. 直接给武器绑一个大一点的胶囊体，不精确描边。采取碰撞体的 `OnTriggerEnter()` 事件来判断是否打到玩家了。

   没想到最后最简单粗暴的方式反而成为了我的选择。

---

下面是关于受击如何传递。

首先玩家被打到了，必然是要让自己当前某个状态进行切换。敌人如何将击中信息告诉玩家，我第一个想到的是事件系统。

武器我会给他一个 `Weapon` 的组件，里面会记录武器的使用者。当判定为击中时，我会调用被击中对象的 `OnDamage` 函数。为此我设计了一个接口 `IDamagable`，一切实现了该接口的对象都可以传递受击信息。

我让 `Player` 实现了该接口，同时我为 `Player` 准备了一个事件，这个事件是公开的，可以被外部订阅和取消订阅。`Player` 的 `OnDamage` 方法只做一件事，那就是调用 `damaged` 事件。

之后就是状态机里的，我让 `PlayerGroundState` 订阅了该事件，并进行了具体实现。同时让它为虚函数可覆写。再在闪避状态里复写一个空函数，便可以很方便的做受击时对闪避无效。

​																																																	               ---- 2025/2/27